---
title: "eda_tennis_R"
author: "Augustus Ge"
date: "12/5/2019"
output: pdf_document
---

```{r}
pacman::p_load(dplyr, caret, corrplot, MASS)
```

```{r}
# Read in files
grass_tennis = read.csv("data/grass_matches_with_feature.csv")
raw_tennis = read.csv("data/mens/combined_raw_data.csv")
round_16 = read.csv("data/wimbledon_2019.csv")
```

```{r}
# Prepare training dataset
features_list = c('diff_rank', 'diff_match_win_percent', 'diff_games_win_percent', 'diff_5_set_match_win_percent', 'diff_close_sets_percent', 'diff_match_win_percent_grass', 'diff_games_win_percent_grass', 'diff_5_set_match_win_percent_grass', 'diff_close_sets_percent_grass', 'diff_match_win_percent_52', 'diff_games_win_percent_52', 'diff_5_set_match_win_percent_52', 'diff_close_sets_percent_52', 'diff_match_win_percent_grass_60', 'diff_games_win_percent_grass_60', 'diff_5_set_match_win_percent_grass_60', 'diff_close_sets_percent_grass_60', 'diff_match_win_percent_hh', 'diff_games_win_percent_hh', 'diff_match_win_percent_grass_hh', 'diff_games_win_percent_grass_hh')

grass_tennis = grass_tennis[complete.cases(grass_tennis), ]
grass_tennis$diff_rank = grass_tennis$player_0_rank - grass_tennis$player_1_rank

grass_tennis = grass_tennis %>% dplyr::select(features_list, "outcome")
```

```{r}
cor(grass_tennis)
```

```{r}
reduced_model = stepAIC(glm(outcome ~ ., data = grass_tennis, family = "binomial"), trace = F)
summary(reduced_model)

reduced_feats = c("diff_rank", "diff_match_win_percent", "diff_5_set_match_win_percent", "diff_match_win_percent_grass", "diff_games_win_percent_grass", "diff_5_set_match_win_percent_grass", "diff_match_win_percent_52", "diff_games_win_percent_grass_60", "diff_games_win_percent_hh")

```

